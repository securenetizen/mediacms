!function(){"use strict";var e,t={1653:function(e,t,i){i.d(t,{Y:function(){return d}});var a=i(5602),n=(i(3203),i(8429));i(1724),i(670);var r=i(6252),o=i(7487);class d extends a.PureComponent{constructor(e,t){super(e),void 0!==t&&n.oh(t)}render(){return a.createElement(a.Fragment,null,a.createElement(r.A,null,this.pageContent()),a.createElement(o.$,null))}}},1724:function(e,t,i){i.d(t,{q:function(){return o}});var a=i(5602),n=i(5909);const r=a.createContext((0,n.$)(window.MediaCMS).site),o=r.Consumer;t.A=r},4833:function(e,t,i){i.r(t),i.d(t,{addMediaToPlaylist:function(){return f},addNewPlaylist:function(){return v},copyEmbedMediaCode:function(){return m},copyShareLink:function(){return c},createPlaylist:function(){return A},deleteComment:function(){return y},dislikeMedia:function(){return s},likeMedia:function(){return o},loadMediaData:function(){return r},removeMedia:function(){return h},removeMediaFromPlaylist:function(){return g},reportMedia:function(){return u},submitComment:function(){return p},undislikeMedia:function(){return l},unlikeMedia:function(){return d}});var a=i(1700),n=i.n(a);function r(){n().dispatch({type:"LOAD_MEDIA_DATA"})}function o(){n().dispatch({type:"LIKE_MEDIA"})}function d(){n().dispatch({type:"UNLIKE_MEDIA"})}function s(){n().dispatch({type:"DISLIKE_MEDIA"})}function l(){n().dispatch({type:"UNDISLIKE_MEDIA"})}function u(e){n().dispatch({type:"REPORT_MEDIA",reportDescription:e?e.replace(/\s/g,""):""})}function c(e){n().dispatch({type:"COPY_SHARE_LINK",inputElement:e})}function m(e){n().dispatch({type:"COPY_EMBED_MEDIA_CODE",inputElement:e})}function h(){n().dispatch({type:"REMOVE_MEDIA"})}function p(e){n().dispatch({type:"SUBMIT_COMMENT",commentText:e})}function y(e){n().dispatch({type:"DELETE_COMMENT",commentId:e})}function A(e){n().dispatch({type:"CREATE_PLAYLIST",playlist_data:e})}function f(e,t){n().dispatch({type:"ADD_MEDIA_TO_PLAYLIST",playlist_id:e,media_id:t})}function g(e,t){n().dispatch({type:"REMOVE_MEDIA_FROM_PLAYLIST",playlist_id:e,media_id:t})}function v(e){n().dispatch({type:"APPEND_NEW_PLAYLIST",playlist_data:e})}},8211:function(e,t,i){var a=i(655),n=i(5602),r=(i(3203),i(8673)),o=i(5762),d=i.n(o),s=i(1724),l=(i(7752),i(8355)),u=i(1336),c=i(863),m=i(2818);function h(e){let t=null,i=e.split(".");if(i.length)switch(i=i[i.length-1],i){case"webm":t="audio/webm";break;case"flac":t="audio/flac";break;case"wave":t="audio/wave";break;case"wav":t="audio/wav";break;case"ogg":case"ogg":t="audio/ogg";break;case"mp3":case"mpeg":t="audio/mpeg"}return t}var p=i(4914),y=i(1206),A=i(2808),f=i(4098);const g=window.MediaPlayer;new f.A;class v extends n.PureComponent{constructor(e){super(e);let t=l.A.get("media-data");this.AudioPlayerData={},this.audioStartedPlaying=!1;let i=(0,p.c)(t.original_media_url,s.A._currentValue.url);this.videoSources=[{src:i,type:h(i)}],this.videoPoster=t.poster_url,this.videoPoster=this.videoPoster?this.videoPoster:t.thumbnail_url,this.videoPoster=this.videoPoster?(0,p.c)(this.videoPoster,s.A._currentValue.url):"",this.updatePlayerVolume=this.updatePlayerVolume.bind(this),this.onAudioEnd=this.onAudioEnd.bind(this),this.onAudioRestart=this.onAudioRestart.bind(this),c.A.on("switched_media_auto_play",this.onUpdateMediaAutoPlay.bind(this)),this.wrapperClick=this.wrapperClick.bind(this);const a=new f.A;a.update(l.A.get("media-data").duration),this.durationISO8601=a.ISO8601()}componentDidMount(){this.videoSources.length||console.warn("Audio DEBUG:","Audio file doesn't exist"),this.recommendedMedia=l.A.get("media-data").related_media.length?new A.A(l.A.get("media-data").related_media,this.refs.AudioElem.parentNode,this.props.inEmbed):null,this.upNextLoaderView=!this.props.inEmbed&&l.A.get("media-data").related_media.length?new y.A(l.A.get("media-data").related_media[0]):null,document.hasFocus()||"visible"===document.visibilityState?this.initPlayerInstance():(this.initPlayerInstance=this.initPlayerInstance.bind(this),window.addEventListener("focus",this.initPlayerInstance),document.addEventListener("visibilitychange",this.initPlayerInstance))}componentWillUnmount(){this.recommendedMedia&&(this.AudioPlayerData.instance.player.off("fullscreenchange",this.recommendedMedia.onResize),c.A.removeListener("window_resize",this.recommendedMedia.onResize),u.A.removeListener("changed_viewer_mode",this.recommendedMedia.onResize),this.recommendedMedia.destroy()),videojs(this.refs.AudioElem).dispose(),this.AudioPlayerData.instance=null,delete this.AudioPlayerData.instance}initPlayerInstance(){window.removeEventListener("focus",this.initPlayerInstance),document.removeEventListener("visibilitychange",this.initPlayerInstance),this.refs.AudioElem.focus(),this.initPlayerInstance=null,setTimeout(function(){if(!this.AudioPlayerData.instance){let e=this.props.inEmbed?document.createElement("a"):null,t=this.props.inEmbed?document.createElement("a"):null;e&&(e.setAttribute("class","title-link"),e.setAttribute("href",l.A.get("media-data").url),e.setAttribute("title",l.A.get("media-data").title),e.setAttribute("target","_blank"),e.innerHTML=l.A.get("media-data").title),t&&(t.setAttribute("class","user-thumb-link"),t.setAttribute("href",l.A.get("media-data").author_profile),t.setAttribute("title",l.A.get("media-data").author_name),t.setAttribute("target","_blank"),t.innerHTML='<img src="'+l.A.get("media-author-thumbnail-url")+'" alt="" />'),this.AudioPlayerData.instance=new g(this.refs.AudioElem,{sources:this.videoSources,poster:this.videoPoster,autoplay:!this.props.inEmbed,bigPlayButton:!0,controlBar:{fullscreen:!1,theaterMode:!1,next:!this.props.inEmbed&&0<l.A.get("media-data").related_media.length},cornerLayers:{topLeft:e,topRight:this.upNextLoaderView?this.upNextLoaderView.html():null,bottomLeft:this.recommendedMedia?this.recommendedMedia.html():null,bottomRight:t}},{volume:u.A.get("player-volume"),soundMuted:u.A.get("player-sound-muted")},null,null,this.onAudioPlayerStateUpdate.bind(this),this.onClickNextButton.bind(this),null),this.upNextLoaderView&&(this.upNextLoaderView.setVideoJsPlayerElem(this.AudioPlayerData.instance.player.el_),this.onUpdateMediaAutoPlay()),this.refs.AudioElem.parentNode.focus(),this.AudioPlayerData.instance.player.one("play",function(){this.audioStartedPlaying=!0}.bind(this)),this.recommendedMedia&&(this.recommendedMedia.initWrappers(this.AudioPlayerData.instance.player.el_),this.AudioPlayerData.instance.player.one("pause",this.recommendedMedia.init),this.AudioPlayerData.instance.player.on("fullscreenchange",this.recommendedMedia.onResize),c.A.on("window_resize",this.recommendedMedia.onResize),u.A.on("changed_viewer_mode",this.recommendedMedia.onResize)),this.AudioPlayerData.instance.player.one("ended",this.onAudioEnd)}}.bind(this),50)}initialDocumentFocus(){this.refs.AudioElem.parentNode&&(this.refs.AudioElem.parentNode.focus(),setTimeout(function(){this.AudioPlayerData.instance.player.play()}.bind(this),50)),window.removeEventListener("focus",this.initialDocumentFocus),this.initialDocumentFocus=null}onClickNextButton(){this.props.inEmbed||(window.location.href=l.A.get("media-data").related_media[0].url)}onUpdateMediaAutoPlay(){this.upNextLoaderView&&(c.A.get("media-auto-play")?this.upNextLoaderView.showTimerView(this.AudioPlayerData.instance.isEnded()):this.upNextLoaderView.hideTimerView())}onAudioPlayerStateUpdate(e){this.updatePlayerVolume(e.volume,e.soundMuted)}onAudioRestart(){this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("inline"),this.AudioPlayerData.instance.player.one("pause",this.recommendedMedia.init),this.AudioPlayerData.instance.player.one("ended",this.onAudioEnd))}onAudioEnd(){if(this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("full"),this.AudioPlayerData.instance.player.one("playing",this.onAudioRestart)),!this.props.inEmbed&&l.A.get("playlist-id")){const e=document.querySelector(".video-player .more-media"),t=document.querySelector(".video-player .vjs-actions-anim");this.upNextLoaderView.cancelTimer();const i=l.A.get("playlist-next-media-url");return i&&(e&&(e.style.display="none"),t&&(t.style.display="none"),window.location.href=i),void this.upNextLoaderView.hideTimerView()}this.upNextLoaderView&&(c.A.get("media-auto-play")?(this.upNextLoaderView.startTimer(),this.AudioPlayerData.instance.player.one("play",function(){this.upNextLoaderView.cancelTimer()}.bind(this))):this.upNextLoaderView.cancelTimer())}onUpdateMediaAutoPlay(){this.upNextLoaderView&&(c.A.get("media-auto-play")?this.upNextLoaderView.showTimerView(this.AudioPlayerData.instance.isEnded()):this.upNextLoaderView.hideTimerView())}updatePlayerVolume(e,t){u.A.get("player-volume")!==e&&m.i_(e),u.A.get("player-sound-muted")!==t&&m.DZ(t)}wrapperClick(e){e.target.parentNode===this.refs.videoPlayerWrap&&(this.AudioPlayerData.instance.player.ended()||(!this.AudioPlayerData.instance.player.hasStarted_||this.AudioPlayerData.instance.player.paused()?this.AudioPlayerData.instance.player.play():this.AudioPlayerData.instance.player.pause()))}render(){return n.createElement("div",{className:"player-container audio-player-container"},n.createElement("div",{className:"player-container-inner"},n.createElement("div",{className:"video-player",ref:"videoPlayerWrap",onClick:this.wrapperClick},n.createElement("audio",{tabIndex:"1",ref:"AudioElem",className:"video-js vjs-mediacms native-dimensions"}))))}}function E(e){const t=(0,n.useContext)(s.A);let i=d();i=i||l.A.get("media-data").thumbnail_url,i=i||"";const[a,r]=(0,n.useState)(i);function o(){r(d())}function d(){const e=l.A.get("media-data");let i="string"==typeof e.poster_url?e.poster_url.trim():"";return""===i&&(i="string"==typeof e.thumbnail_url?e.thumbnail_url.trim():""),""===i&&(i="string"==typeof l.A.get("media-original-url")?l.A.get("media-original-url").trim():""),""===i?"#":t.url+"/"+i.replace(/^\//g,"")}return(0,n.useEffect)((()=>(l.A.on("loaded_image_data",o),()=>l.A.removeListener("loaded_image_data",o))),[]),a?n.createElement("div",{className:"viewer-image-container"},n.createElement("img",{src:a,alt:l.A.get("media-data").title||null})):null}function w(){return n.createElement("div",{className:"player-container viewer-pdf-container"},n.createElement("div",{className:"player-container-inner"},n.createElement("span",null,n.createElement("span",null,n.createElement("i",{className:"material-icons"},"insert_drive_file")))))}function P(){return n.createElement("div",{className:"player-container viewer-attachment-container"},n.createElement("div",{className:"player-container-inner"},n.createElement("span",null,n.createElement("span",null,n.createElement("i",{className:"material-icons"},"insert_drive_file")))))}v.defaultProps={inEmbed:!1},v.propTypes={inEmbed:d().bool};var M=i(1653),_=i(4833),b=i(1054),L=(i(634),i(1934));M.Y;var D=i(9122);class N extends M.Y{constructor(e){super(e,"media"),this.state={wideLayout:1216<=c.A.get("window-inner-width"),mediaLoaded:!1,mediaLoadFailed:!1,isVideoMedia:!1,theaterMode:!1,pagePlaylistLoaded:!1,pagePlaylistData:l.A.get("playlist-data")},this.onWindowResize=this.onWindowResize.bind(this),this.onMediaLoad=this.onMediaLoad.bind(this),this.onMediaLoadError=this.onMediaLoadError.bind(this),this.onPagePlaylistLoad=this.onPagePlaylistLoad.bind(this),l.A.on("loaded_media_data",this.onMediaLoad),l.A.on("loaded_media_error",this.onMediaLoadError),l.A.on("loaded_page_playlist_data",this.onPagePlaylistLoad)}componentDidMount(){_.loadMediaData(),c.A.on("window_resize",this.onWindowResize)}onWindowResize(){this.setState({wideLayout:1216<=c.A.get("window-inner-width")})}onPagePlaylistLoad(){this.setState({pagePlaylistLoaded:!0,pagePlaylistData:l.A.get("playlist-data")})}onMediaLoad(){const e="video"===l.A.get("media-type");e?(this.onViewerModeChange=this.onViewerModeChange.bind(this),u.A.on("changed_viewer_mode",this.onViewerModeChange),this.setState({mediaLoaded:!0,isVideoMedia:e,theaterMode:u.A.get("in-theater-mode")})):this.setState({mediaLoaded:!0,isVideoMedia:e})}onViewerModeChange(){this.setState({theaterMode:u.A.get("in-theater-mode")})}onMediaLoadError(e){this.setState({mediaLoadFailed:!0})}pageContent(){const e="cf viewer-section"+(this.state.theaterMode?" theater-mode":" viewer-wide"),t="viewer-section-nested"+(this.state.theaterMode?" viewer-section":"");return this.state.mediaLoadFailed?n.createElement("div",{className:e},n.createElement(b.A,null)):n.createElement("div",{className:e},[n.createElement("div",{className:"viewer-container",key:"viewer-container"},this.state.mediaLoaded&&this.state.pagePlaylistLoaded?this.viewerContainerContent(l.A.get("media-data")):null),n.createElement("div",{key:"viewer-section-nested",className:t},!this.state.wideLayout||this.state.isVideoMedia&&this.state.theaterMode?[n.createElement(D.A,{key:"viewer-info"}),this.state.pagePlaylistLoaded?n.createElement(L.A,{key:"viewer-sidebar",mediaId:l.A.get("media-id"),playlistData:l.A.get("playlist-data")}):null]:[this.state.pagePlaylistLoaded?n.createElement(L.A,{key:"viewer-sidebar",mediaId:l.A.get("media-id"),playlistData:l.A.get("playlist-data")}):null,n.createElement(D.A,{key:"viewer-info"})])])}}(0,a.C)("page-media",class extends N{viewerContainerContent(e){switch(l.A.get("media-type")){case"video":return n.createElement(s.q,null,(t=>n.createElement(r.A,{data:e,siteUrl:t.url,inEmbed:!1})));case"audio":return n.createElement(v,null);case"image":return n.createElement(E,null);case"pdf":return n.createElement(w,null)}return n.createElement(P,null)}})}},i={};function a(e){var n=i[e];if(void 0!==n)return n.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,a),r.exports}a.m=t,e=[],a.O=function(t,i,n,r){if(!i){var o=1/0;for(u=0;u<e.length;u++){i=e[u][0],n=e[u][1],r=e[u][2];for(var d=!0,s=0;s<i.length;s++)(!1&r||o>=r)&&Object.keys(a.O).every((function(e){return a.O[e](i[s])}))?i.splice(s--,1):(d=!1,r<o&&(o=r));if(d){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[i,n,r]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.j=201,function(){var e={201:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,r,o=i[0],d=i[1],s=i[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(n in d)a.o(d,n)&&(a.m[n]=d[n]);if(s)var u=s(a)}for(t&&t(i);l<o.length;l++)r=o[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},i=self.webpackChunkmediacms_frontend=self.webpackChunkmediacms_frontend||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var n=a.O(void 0,[276],(function(){return a(8211)}));n=a.O(n)}();